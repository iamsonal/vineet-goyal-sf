# Contributing to Lightning Data Service

## Release

### Update LDS 222 code

Currently the generated artifact for core is a combination of both LDS 222 (`lds222` branch) and LDS 224 (`master` branch). Before doing any release you will need to make sure that the LDS 222 branch artifact is up to date. You can run the following commands to generate the LDS 222 artifacts.

```sh
git checkout lds222
git pull origin lds222
yarn
```

Then you will need to copy the artifact located at `dist/targets/lwc/lds.js` on the `lds222` branch to `packages/core-build/src/lds222/main.js` on the `master` branch.

### Release the artifact in core

```sh
yarn release                        # release artifact to main core branch
yarn release --branch=224/patch     # release artifact to the 224/patch core branch
```

The BLT installation path can be overridden via the `BLT_HOME` environment variable (default: `~/blt`). If you have a custom BLT installation path make sure to run `source ./env.sh` in at the root of the BLT install before running the release script.

## Maintenance

### Update the RAML definitions from core

In order to write wire adapters for newly exposed UI APIs in core, LDS first needs to be made aware of these by adding the corresponding RAML definitions. Every core server exposes a `connectSchema.jsp` download RAML definitions, for instance: `https://na44.stmfa.stm.salesforce.com/qa/connectSchema.jsp`. Download the correct version from this line `uisdk-connect-api-RAML1`. Once downloaded merge the changes in the raml definition file `/packages/@salesforce-lds-api/uiapi-records/src/raml/api.raml`.

For the time being, the following changes have to be retained in the `api.raml`:

- Many `type` definitions need an additional `| nil` at the end.
- Some `type` definitions are redefined, such as `type: nil | string | integer | boolean | RecordRepresentation`.
- The following representations need to be retained as they are not yet generated by RAML:
  - `Field`, `Canvas`, `ReportChart`, `CustomLink`, `VisualforcePage`, `EmptySpace`
  - `BatchRepresentation`, `RecordAvatarValidResult`, `RecordAvatarRepresentation`, `RecordAvatarBulkRepresentation`
- `RecordInputRepresentation` changes a few attribute values.
- `RecordLayoutComponentRepresentation` redefines `type`.
- `/record-avatars/batch/{recordIds}` redefines response `body`.
- PATCH `/record/{recordId}`adds `headers` as an additional attribute
- Multiple `uriParameters` have a changed order to match the URL order
